This folder includes programs that process data from the PME for the main exercises of the paper. It also includes code to perform the exercise in Online Appendix H using data from the Brazilian Census. 

This folder also includes a file "labor share.xls". This file contains our estimation of the standard error associated with the labor share target for estimation.

=========================================
SOFTWARE REQUIREMENTS
=========================================
The programs require Stata. The code was run on Stata MP versions 15.1 and 16.1. 


=========================================
HARDWARE REQUIREMENTS
=========================================
The programs are moderately time consuming, but do not require specialized hardware or a computer cluster. Processing the PME, including obtaining bootstrapped statistics, should take less than a day using modern personal computers.

Cleaning and collapsing data from the Census may take a few days but not more than a week. A computer with 16 GB of RAM is enough (but not 8 GB). Running the regressions on the clean, collapsed data set is very quick and requires very little memory.


=========================================
DATA REQUIREMENTS
=========================================
- Data from the PME survey is publicly available at the website of the Brazilian Statistics Bureau (IBGE, "Instituto Brasileiro de Geografia e Estatística" - ibge.gov.br). The data was read and cleaned using code provided by the Data Zoom project, from the Economics Department at PUC-Rio (Pontifícia Universidade Católica do Rio de Janeiro). Data Zoom is currently available at http://www.econ.puc-rio.br/datazoom/english/ . 
The code assumes that the microdata files generated by Data Zoom are available (Panels D, E, F, G, H, R, S, and T).

- We also use data from the paper "Enforcement of Labor Regulation and Informality", by Rita Almeida and Pedro Carneiro, published at the American Economic Journal:Applied Economics 4(3) from 2012. DOI: 10.1257/app.4.3.64 
The data can be downloaded at the article's website (https://www.aeaweb.org/articles?id=10.1257/app.4.3.64). It is also provided here for convenience (file AlmeidaCarneiroData.dta).

- Census data is also created and maintained by IBGE. Currently, microdata for the years 2000 and 2010 are available for download at the IBGE website. The code also requires data from 1991; researchers interested in obtaining that data should reach out to the IBGE (there might be small financial costs associated with making that data available). The clean, collapsed data at the microregion-year level, which is used in the regressions in Appendix H, is provided in this replication package (the census_collapsed_data.dta file in this folder).


=========================================
INSTRUCTIONS AND DESCRIPTION OF THE PROGRAMS
=========================================
To simplify the explanation of the code, I will list and describe programs separately according to two parts: processing data from the PME for the main exercises in the paper, and the robustness exercise in Online Appendix H using data from the Brazilian Census.

The full description of the procedures executed in these programs is provided in the online appendix.


=========================================
PART 1: PROCESSING THE PME
=========================================
Instructions: Run the runAll.do script, if replicating from scratch using PME microdata. Otherwise, no action is necessary, since the clean data files are available in the CleanData folder.

Description of files:

- runAll.do: This is the main file which creates input files for the Matlab procedures, calling getMoments.do and getNationalMoments.do.

- getMoments.do: This file processes the PME data and generates statistics as described in the online appendix. It is called several times in runAll.do. The main outputs are the files ../CleanData/pme_2003_regions.csv and ../CleanData/pme_2012_regions.csv. It also generates summary statistics used to generate Table 1 in the paper: ../CleanData/summaryTable1_2003.csv and ../CleanData/summaryTable1_2012.csv. Finally, it creates a series of bootstrapped statistics: the files ../CleanData/Bootstrap/pme_2003_regions_*.csv and ../CleanData/Bootstrap/pme_2012_regions_*.csv, where * is a number from 1 through 100.

- getNationalMoments.do: This file runs the IV estimation using data from Almeida and Carneiro. The main output is ../CleanData/national_2003.csv. It also generates bootstrapped statistics, ../CleanData/Bootstrap/national_2003_*.csv. NOTE: code in this file is based on the original code from Rita Almeida and Pedro Carneiro, for which we are grateful.


=========================================
PART 2: CENSUS REGRESSIONS (APPENDIX H)
=========================================
Instructions: Run census_dataCleaning.do, then census_collapse.do, then census_regreessions.do, is replicating from scratch using Census microdata. Otherwise, just run census_rehgressions.do.

Description of files:

- census_dataCleaning.do: This script reads the Census microdata using Data Zoom, process it, and saves an intermediate data file (census_person.dta, not included in this replication package).

- census_collapse.do: This script reads census_person.dta and executes procedures described in Appendix H to create a data set at the microregion-year level, census_collapsed_data.dta (included in this folder).

- census_regressions.do: This script runs the regressions and saves four files with the results in the ../Output folder: Tab_formal_noeduc.csv, Tab_formal_allc.csv, Tab_employed_noeduc.csv, and Tab_employed_allc.csv.
