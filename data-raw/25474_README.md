---
contributors:
  - Daniel G Garrett
  - Andrey Ordin
  - James W Roberts
  - Juan Carlos Suarez Serrato
---

# README

Overview
--------

INSTRUCTIONS:  

The code in this replication package constructs the analysis file from a variety of data sources (SDC Platinum, The Bond Buyer, and assorted others -- see below) using Stata and MatLab. Two main files run all of the code to generate the data for the 25 figures and 37 tables in the paper. The replicator should expect the code to run for about 24 hours.

Data Availability Statement
----------------------------

### Summary of Availability

- Some data cannot be made publicly available.

### Details on each Data Source

- Data on bids in the auctions was obtained from The Bond Buyer (2016). We use all competitive sales results from January 1, 2008 through December 31, 2015. These data can be obtained at https://www.bondbuyer.com in the bond sales results archive. Access requires an account with The Bond Buyer. 
  - Datafile: `Raw Data/bb_bonds.csv` (not provided)
- Supplementary data on bids in the auctions and negotiated sales was obtained from SDC Platinum (2016). Requires a subscription. More details available at https://www.refinitiv.com/en/products/sdc-platinum-financial-securities.
  - Datafiles: `Raw Data/sdc_parsed.csv`, `Raw Data/expanded_sdc_merge.dta` (not provided)
- Tax rate variables from TAXSIM (see Feenberg, 2019, and Feenberg and Coutts, 1993)
- Tax base variables from CCH State Tax Handbooks (CCH, 2015)
- Political party controls from Ceaser and Saldin (2005)
- Other tax policy and economic controls, including
  - US state GDP quarterly (Bureau of Economic Analysis, 2017)
  - State and local government finances (Census Bureau, 2014)
  - 1-Year and 10-Year swap rates (Board of Governors of the Federal Reserve System, 2018a and 2018b)
  - Muni swap rates (SIFMA, 2020)
  - Share of high earners among taxpayers (Internal Revenue Service, 2007)
  - State unemployment rates (Bureau of Labor Statistics, 2017)
  - State credit ratings (Moody's Investors Service, 2016)


Dataset list
------------

| Data file                  | Source       | Notes    |Provided |
| ---------------------------| ------------ |----------|---------|
| `Raw Data/bb_bonds.csv`  | The Bond Buyer | Variables include issuer name, sale year, sale month, sale day, size, sale type, callability indicator, buyer's name, price, rate type, bids, bidder names | No |
| `Raw Data/sdc_parsed.csv` | SDC Platinum | Variables are from the Deluxe Report generated by SDC Platinum | No |
| `Raw Data/expanded_sdc_merge.dta` | SDC Platinum | Complete bond characteristics available in SDC for bonds in sample | No |
| `Raw Data/taxsim_2015.txt` and `Raw Data/tax_simrates.txt` | https://users.nber.org/~taxsim/state-rates/maxrate.html | The project uses data for 2006-2017 only | Yes |
| `Raw Data/taxsim_output_data_ui.txt` | https://users.nber.org/~taxsim/ | Replications of the taxsim program for other income levels | Yes |
| `Raw Data/tax_bases.txt` | CCH State Tax Handbooks | 2008-2015 versions | Yes |
| `Raw Data/beta_alpha_state.dta` | Suarez Serrato and Zidar (2016) | Measures of state tax progressivity | Yes  |
| `Raw Data/bea_gdp.csv` | BEA state GDP Estimates by quarter | Accessed February 2, 2017 | Yes |
| `Raw Data/census_of_govts_data.dta` | https://www.census.gov/programs-surveys/gov-finances/data/datasets.html |State and Local Government Finances through the Census. Files `FIN92EST.txt`-`SLF_2014.csv` are the raw data before being combined. `01Indunit_1120.txt` and `2003FinInddiv5_noimps030806.txt` replace 2001 and 2003, respectively.|Yes|
| `Raw Data/data_stsmus.dta` | Replication data file for Suarez Serrato and Zidar (2016) | Combines many other local tax by year variables: sales, property, and corporate income tax rates and bases. | Yes |
| `Raw Data/DSWP1.csv` | https://fred.stlouisfed.org/series/DSWP1 | 1-year Treasury Swap Rate | Yes |
| `Raw Data/DSWP10.csv` | https://fred.stlouisfed.org/series/DSWP10 | 10-year Treasury Swap Rate | Yes |
| `Raw Data/psaswaps_excel_file.xls` | https://www.sifma.org/resources/research/swap/ | 2008-2013 muni swap rates | Yes |
| `Raw Data/Muni-Swap-Historical-Data.xlsx` | https://www.sifma.org/resources/research/swap/ | 2014-2015 muni swap rates | Yes |
| `Raw Data/Top_earners.xlsx` | https://www.irs.gov/statistics/soi-tax-stats-historic-table-2 | Share of tax filings over $200,000 in the 2007 year | Yes |
| `Raw Data/MPI.dta` | https://scholar.harvard.edu/saldin/data                      | Major Party Index from Ceaser and Saldin (2005) | Yes |
| `Raw Data/unemployment_LAU.csv` | https://www.bls.gov/lau/ | State Unemployment rates, 2008-2015 | Yes |
| `Raw Data/state_credit_test.txt` | https://users.nber.org/~taxsim/ combined with Bloomberg | State credit ratings, manually added from Bloomberg terminal to tax rate data | Yes |


Computational requirements
---------------------------

### Software Requirements

- Stata (code was last run with version 17)
  - Necessary modules for Stata are installed on the fly using `ssc install`
- MatLab (code was last run with MatLab version 9.10.0.1710957 (R2021a))
  - MatLab code requires Financial Toolbox (we used ver. 6.1) and Mapping Toolbox (we used ver. 5.1)


### Memory and Runtime Requirements

#### Summary

Approximate time needed to reproduce the analyses on a standard (Year 2021) desktop machine is 3-5 days.

#### Details

Stata code takes about 10 minutes to run on a modern machine. No parallelization is used.

MatLab code was last run on a **32-core Intel-based desktop using 64GB of RAM and 32 parallel workers**. Computation took 20 hours.

- Approximately 75% of the time was spent on simulations for the robustness checks, including the scripts `script_fit.m` and `script_sim.m`. 
- If you would like to skip some of the computations, you can adjust the variable `mdlID_array` in the master script; additionally, however, you will also need to change what is being printed by the script `script_results.m`, since it will crash by default if some of the simulations are not performed.
- If DO_RESULTS_ONLY is set to `true`, the scripts take about 30 minutes to execute, and no parallelization is used.


Description of programs/code
----------------------------

- Stata code builds the dataset and performs various reduced-form analyses. The main script is `Programs/restud_replication_stata_master.do`. First, it calls other scripts that put the sample together; next, it calls the scripts that produce various figures and tables used in the paper.
- The main Stata script should be run from the folder it is located in. In-script file paths are set relative to that folder.
- MatLab code performs all counterfactuals. The main script is `Programs/Structural/MasterScript.m`. It reads the input data prepared by the Stata scripts, generates the files with the number of potential bidders, and proceeds to run the simulations of the models. Supplementary MatLab scripts are contained in `Programs/Structural/scripts` while the functions are stored in `Programs/Structural/funs`. Different scripts and functions generate intermediate results of simulations in `Programs/Structural/output`; however, the tables and figures used in the paper are all stored in `Output/`.
- The main MatLab script should be run from the folder it is located in. Additionally, you may be interested in adjusting two variables in the beginning of the script:
  - DO_RESULTS_ONLY (boolean) should be `false` if you would like to redo all simulations in the paper. We have included the simulation files with the package. By default, DO_RESULTS_ONLY is set to `true`.
  - NPROC defines the number of parallel workers. The default value is 32.

- Note that MatLab uses files that contain solution points for the baseline model as well as various robustness checks. These solutions are stored in `Programs/Structural/output/sol`. These files should not be deleted. Other files in `Programs/Structural/output` contain intermediate computations. You can remove the files, but then you will need to run the scripts with DO_RESULTS_ONLY set to `false` to generate them again.

Instructions to Replicators
---------------------------

- Run `Programs/restud_replication_stata_master.do` from the folder that contains it.
  - Note the data access restrictions.

- Run `Programs/Structural/MasterScript.m` from the folder that contains it.
  - Stata code must be run first, since it prepares the input files used by MatLab code.
  - You can also readjust the values of DO_RESULTS_ONLY and NPROC in the MatLab script as discussed above.
  
- All the tables and figures, including those in the online appendix, can be found in `Output/`.

<u>Note</u>: Files containing the definition of potential bidders `Output/npoten.csv`, `Output/npoten_inc_small.csv`, and `Output/npoten_decomp.csv` are generated by MatLab but are used by Stata. To keep the order of script execution simple, we copied these files over to `Raw Data/`.

List of tables and programs
---------------------------

The provided code reproduces all tables and figures in the paper. All tables and figures are stored in the `Output` folder and have intuitive names, with the exception of maps which are stored in `Output/maps`.


| Figure/Table #    | Program                  | Note                            |
|-------------------|--------------------------|---------------------------------|
| <u>Main Text</u> |  | Requires restricted data |
| Table 1           | Programs/table1.do |See the Stata master script for details|
| Table 2           | Programs/table2.do |See the Stata master script for details|
| Tables 3,4,6,7    | Programs/Structural/scripts/script_results.m ||
| Table 5 | Programs/Structural/scripts/script_illustrate.m ||
| Figures 1-4       | Programs/Structural/scripts/script_results.m |  |
| <u>Appendix</u> |                                                              | Requires restricted data |
| Tables A.1-A.20 | Programs/tableA*.do | See the Stata master script for details |
| Tables A.21-A.30 | Programs/Structural/scripts/script_results.m |  |
| Figures A.1, A.3-A.7    | Programs/figureA*.do | See the Stata master script for details |
| Figures A.2, A.18--A.21 | Programs/Structural/scripts/script_results.m |  |
| Figures A.8-A.15 | Programs/Structural/funs/script_map.m |  |

## References

Board of Governors of the Federal Reserve System (2018a). "1-Year Swap Rate (DISCONTINUED) [DSWP1]," FRED, Federal Reserve Bank of St. Louis. Last accessed on 2018-04-18. https://fred.stlouisfed.org/series/DSWP1

Board of Governors of the Federal Reserve System (2018b). "10-Year Swap Rate (DISCONTINUED) [DSWP10]," FRED, Federal Reserve Bank of St. Louis. Last accessed on 2018-04-18. https://fred.stlouisfed.org/series/DSWP10

Bureau of Economic Analysis (2017). "Annual Gross Domestic Product (GDP) by State." Last accessed on 2017-04-26. https://www.bea.gov/regional/downloadzip.cfm

Bureau of Labor Statistics (2017). "Local Area Unemployment Statistics." Last accessed on 2017-04-26. https://www.bls.gov/lau/

CCH (2015). "State Tax Handbook 2008-2015." CCH Incorporated State Tax Handbook, Toolkit Media Group.

Census Bureau (2014). "State and Local Government Finance Historical Data 1994-2014." Last accessed on 2017-04-26. https://www.census.gov/programs-surveys/gov-finances/data/datasets.html

Ceaser, J. W., and R. P. Saldin (2005). "A new measure of party strength." <u>Political Research Quarterly</u> 58(2): 245-256.

Feenberg, D. (2019). "Internet TAXSIM." Last modified July 29, 2019. https://www.nber.org/taxsim/

Feenberg, D., and E. Coutts (1993). "An introduction to the TAXSIM model." <u>Journal of Policy Analysis and management</u>, *12*(1), 189-194.

Internal Revenue Service (2007). "SOI Tax Stats - Historic Table 2." The Internal Revenue Service. Last accessed on 2016-09-28. https://www.irs.gov/statistics/soi-tax-stats-historic-table-2

Moody's Investors Service (2016). "State Credit Ratings 2004-2014." Bloomberg [data provider]. Last accessed on 2016-10-05.

SDC Platinum (2016). "SDC Platinum Global Public Finance." Thomson SDC Platinum Database, last accessed on 2017-03-21. https://www.refinitiv.com/en/products/sdc-platinum-financial-securities

SIFMA (2020). "SIFMA Swap Index." Securities Industry and Financial Markets Association. Last accessed on 2020-08-12. https://www.sifma.org/resources/research/swap/

Suárez Serrato, J. C., and O. Zidar (2016). "Who benefits from state corporate tax cuts? A local labor markets approach with heterogeneous firms." <u>American Economic Review</u>, 106(9): 2582-2624.

The Bond Buyer (2016). "Competitive sales results." The Bond Buyer, last accessed on 2017-03-21. https://www.bondbuyer.com
